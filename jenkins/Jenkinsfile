pipeline {

  agent any
  stages {

    stage('Build') {
      steps {
        sh './gradlew clean assemble'
      }
    }

    stage('Test') {
      steps {
        sh './gradlew cucumber'
        sh './gradlew test'
        publishHTML(
          [
            allowMissing: false, 
            alwaysLinkToLastBuild: false, 
            keepAll: false, 
            reportDir: 'build/reports/bdd/cucumber-html-reports/', 
            reportFiles: 'overview-features.html', 
            reportName: 'Cucumber Report', 
            reportTitles: ''
           ]
         )
      }

      post {
        always {
          junit 'build/test-results/test/*.xml'

        }
      }

    }

  }

}
